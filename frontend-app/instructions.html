<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Processing System - Instructions</title>
    <!-- Include env.js first to set the API Base URL -->
    <script src="env.js"></script>
    <script src="config.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        header {
            background-color: #4a6cf7;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        header h1 {
            margin: 0;
            font-size: 28px;
        }

        nav {
            margin-top: 15px;
        }

        nav ul {
            list-style: none;
            padding: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        nav a:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        nav a.active {
            background-color: rgba(255, 255, 255, 0.3);
            font-weight: bold;
        }

        .container {
            background-color: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .step {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border-left: 5px solid #4a6cf7;
        }

        .step h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
            font-size: 20px;
        }

        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background-color: #4a6cf7;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
        }

        .code-block {
            background-color: #f1f1f1;
            color: #333;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: monospace;
            border-left: 3px solid #4a6cf7;
        }

        .note {
            background-color: #fff8e1;
            border-left: 4px solid #ffd600;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .warning {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid transparent;
            margin-bottom: -1px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab:hover {
            background-color: #f5f5f5;
        }

        .tab.active {
            border: 1px solid #ddd;
            border-bottom-color: white;
            border-radius: 4px 4px 0 0;
            background-color: white;
            color: #4a6cf7;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 15px 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #4a6cf7;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            margin-top: 10px;
            font-weight: 500;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #3a5ce5;
        }

        ol,
        ul {
            padding-left: 25px;
        }

        li {
            margin-bottom: 10px;
        }

        h2 {
            color: #4a6cf7;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-top: 30px;
        }

        .error-box {
            background-color: #ffebee;
            border-left: 5px solid #f44336;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .error-box h4 {
            color: #d32f2f;
            margin-top: 0;
        }

        .solution-box {
            background-color: #e8f5e9;
            border-left: 5px solid #4caf50;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .solution-box h4 {
            color: #2e7d32;
            margin-top: 0;
        }
    </style>
</head>

<body>
    <header>
        <h1>Video Processing System</h1>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="config.html">Configuration</a></li>
                <li><a href="instructions.html" class="active">Instructions</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">
        <h2>Simple Guide for Non-Technical Users</h2>
        <p>This guide will help you set up and use the Video Processing System with your AWS account. We'll walk
            through each step in simple terms.</p>

        <div class="tabs">
            <div class="tab active" onclick="openTab('setup')">Setup</div>
            <div class="tab" onclick="openTab('usage')">Using the Service</div>
            <div class="tab" onclick="openTab('limitations')">Serverless Limitations</div>
            <div class="tab" onclick="openTab('troubleshooting')">Troubleshooting</div>
        </div>

        <div id="setup" class="tab-content active">
            <div class="step">
                <h3><span class="step-number">1</span>Create an AWS Account</h3>
                <p>If you don't already have an AWS account, you'll need to create one:</p>
                <ol>
                    <li>Go to <a href="https://aws.amazon.com/" target="_blank">aws.amazon.com</a></li>
                    <li>Click "Create an AWS Account" button in the top right</li>
                    <li>Follow the instructions to create your account</li>
                    <li>You'll need to provide a credit card, but many AWS services have a free tier</li>
                </ol>
                <div class="note">
                    <p><strong>Note:</strong> AWS will charge you for the resources you use. Make sure to monitor your
                        usage to avoid unexpected charges.</p>
                </div>
            </div>

            <div class="step">
                <h3><span class="step-number">2</span>Create an S3 Bucket</h3>
                <p>S3 is where your videos will be stored:</p>
                <ol>
                    <li>Sign in to the AWS Management Console</li>
                    <li>Search for "S3" in the search bar at the top</li>
                    <li>Click on "S3" in the search results</li>
                    <li>Click the "Create bucket" button</li>
                    <li>Enter a unique bucket name (like "my-video-bucket-123")</li>
                    <li>Select your preferred region (e.g., "ap-south-1")</li>
                    <li>Leave all other settings as default</li>
                    <li>Scroll down and click "Create bucket"</li>
                </ol>
                <div class="note">
                    <p><strong>Remember:</strong> Write down your bucket name - you'll need it later!</p>
                </div>
            </div>

            <div class="step">
                <h3><span class="step-number">3</span>Create IAM User and Get Access Keys</h3>
                <p>You need access keys to let the application use your AWS account:</p>
                <ol>
                    <li>In the AWS Console, search for "IAM" and click on it</li>
                    <li>In the left sidebar, click "Users"</li>
                    <li>Click "Create user"</li>
                    <li>Enter a name like "video-transcoder-user"</li>
                    <li>Click "Next"</li>
                    <li>Select "Attach policies directly"</li>
                    <li>Search for and select these policies:
                        <ul>
                            <li>AmazonS3FullAccess</li>
                            <li>AmazonECSFullAccess</li>
                            <li>CloudWatchLogsFullAccess</li>
                        </ul>
                    </li>
                    <li>Click "Next" and then "Create user"</li>
                    <li>Click on the user you just created</li>
                    <li>Go to the "Security credentials" tab</li>
                    <li>Scroll down to "Access keys" and click "Create access key"</li>
                    <li>Select "Application running outside AWS"</li>
                    <li>Click "Next" and then "Create access key"</li>
                    <li><strong>IMPORTANT:</strong> Download the CSV file or copy both the Access Key ID and Secret
                        Access Key - you will need these later and won't be able to see the Secret Access Key again!
                    </li>
                </ol>
                <div class="warning">
                    <p><strong>Warning:</strong> Never share your Secret Access Key with anyone. It gives access to your
                        AWS account and resources.</p>
                </div>
            </div>

            <div class="step">
                <h3><span class="step-number">4</span>Create an ECS Cluster</h3>
                <p>ECS is the service that will run the video transcoding:</p>
                <ol>
                    <li>In the AWS Console, search for "ECS" and click on it</li>
                    <li>Click "Clusters" in the left sidebar</li>
                    <li>Click "Create Cluster"</li>
                    <li>Enter "video-transcoder-cluster" as the cluster name</li>
                    <li>Under "Infrastructure", select "AWS Fargate (serverless)"</li>
                    <li>Leave all other settings as default</li>
                    <li>Click "Create"</li>
                </ol>
                <div class="note">
                    <p><strong>Note:</strong> After creating the cluster, you'll see an ARN (Amazon Resource Name) that
                        looks like: <code>arn:aws:ecs:ap-south-1:123456789012:cluster/video-transcoder-cluster</code>.
                        Write this down - you'll need it later.</p>
                </div>
            </div>

            <div class="step">
                <h3><span class="step-number">5</span>Create a Task Definition</h3>
                <p>This tells AWS how to run the transcoding software:</p>
                <ol>
                    <li>In the ECS console, click "Task Definitions" in the left sidebar</li>
                    <li>Click "Create new Task Definition"</li>
                    <li>Select "Fargate" as the launch type</li>
                    <li>Click "Next step"</li>
                    <li>Enter "video-transcoder" as the task definition name</li>
                    <li>For "Task Role", select "ecsTaskExecutionRole" (create it if it doesn't exist)</li>
                    <li>For "Task execution role", select "ecsTaskExecutionRole"</li>
                    <li>Set "Task memory" to "4GB"</li>
                    <li>Set "Task CPU" to "2 vCPU"</li>
                    <li>Click "Add container"</li>
                    <li>Enter "video-transcoder" as the container name</li>
                    <li>Enter "767828740984.dkr.ecr.ap-south-1.amazonaws.com/sasa-trnscd:latest" as the image</li>
                    <li>Set "Memory Limits" to "4096"</li>
                    <li>Leave "Port mappings" empty</li>
                    <li>Under "Environment variables", add:
                        <ul>
                            <li>Name: AWS_REGION, Value: your region (e.g., ap-south-1)</li>
                            <li>Name: AWS_ACCESS_KEY_ID, Value: your access key</li>
                            <li>Name: AWS_SECRET_ACCESS_KEY, Value: your secret key</li>
                            <li>Name: BUCKET_NAME, Value: your S3 bucket name</li>
                        </ul>
                    </li>
                    <li>Click "Add"</li>
                    <li>Click "Create"</li>
                </ol>
                <div class="note">
                    <p><strong>Note:</strong> After creating the task definition, note the name and revision number
                        (e.g., "video-transcoder:1"). You'll need this later.</p>
                </div>
            </div>

            <div class="step">
                <h3><span class="step-number">6</span>Get Your VPC Information</h3>
                <p>You need subnet and security group information for the application:</p>
                <ol>
                    <li>In the AWS Console, search for "VPC" and click on it</li>
                    <li>In the left sidebar, click "Subnets"</li>
                    <li>Note the IDs of at least two subnets (they look like "subnet-1234abcd")</li>
                    <li>In the left sidebar, click "Security Groups"</li>
                    <li>Note the ID of the default security group (it looks like "sg-1234abcd")</li>
                </ol>
                <div class="note">
                    <p><strong>Note:</strong> Write down the subnet IDs and security group ID - you'll need these for
                        configuration.</p>
                </div>
            </div>

            <div class="step">
                <h3><span class="step-number">7</span>Configure the Application</h3>
                <p>Now you'll set up the application with all the information you've gathered:</p>
                <ol>
                    <li>Go to the Configuration page: <a href="config.html">Open Configuration</a></li>
                    <li>Fill in the following details:
                        <ul>
                            <li><strong>AWS Region:</strong> Your AWS region (e.g., ap-south-1)</li>
                            <li><strong>AWS Access Key ID:</strong> Your IAM user's access key</li>
                            <li><strong>AWS Secret Access Key:</strong> Your IAM user's secret key</li>
                            <li><strong>S3 Bucket Name:</strong> The name of your S3 bucket</li>
                            <li><strong>ECS Cluster:</strong> The ARN of your ECS cluster (e.g.,
                                arn:aws:ecs:ap-south-1:<strong>YOUR-ACCOUNT-ID</strong>:cluster/video-transcoder-cluster)
                            </li>
                            <li><strong>ECS Task Definition:</strong> Your task definition name and revision (e.g.,
                                video-transcoder:1)</li>
                            <li><strong>ECS Subnets:</strong> Your subnet IDs, separated by commas (e.g.,
                                subnet-1234abcd,subnet-5678efgh)</li>
                            <li><strong>ECS Security Groups:</strong> Your security group ID (e.g., sg-1234abcd)</li>
                        </ul>
                    </li>
                    <li><strong>Important:</strong> Make sure your subnets are in a VPC with internet access through a
                        NAT Gateway or Internet Gateway, as the application uses Fargate launch type which requires
                        internet access.</li>
                    <li>Click "Test Connection" to verify your configuration</li>
                    <li>If the test is successful, click "Save Configuration"</li>
                </ol>
                <div class="note">
                    <p><strong>Note about Subnets:</strong> For Fargate tasks, your subnets must have internet access.
                        If you're using private subnets, they must have a route to a NAT Gateway. If you're using public
                        subnets, they must have a route to an Internet Gateway.</p>
                </div>
            </div>
        </div>

        <div id="usage" class="tab-content">
            <div class="step">
                <h3><span class="step-number">1</span>Upload a Video</h3>
                <ol>
                    <li>Go to the Home page: <a href="index.html">Open Home</a></li>
                    <li>Click "Choose File" to select a video file from your computer</li>
                    <li>Click "Upload" to upload the video to your S3 bucket</li>
                    <li>Wait for the upload to complete - you'll see a success message when it's done</li>
                    <li>Once the upload is complete, click "Start Transcoding"</li>
                </ol>
                <div class="note">
                    <p><strong>Note:</strong> The maximum file size is 500MB. Larger files may fail to upload.</p>
                </div>
            </div>

            <div class="step">
                <h3><span class="step-number">2</span>Monitor Your Transcoding Job</h3>
                <ol>
                    <li>After starting a transcoding job, you'll be automatically redirected to the Jobs tab</li>
                    <li>Here you can see the status of all your transcoding jobs</li>
                    <li>The status will be one of:
                        <ul>
                            <li><strong>PENDING:</strong> The job is waiting to start</li>
                            <li><strong>RUNNING:</strong> The job is currently processing your video</li>
                            <li><strong>COMPLETED:</strong> The job has finished successfully</li>
                            <li><strong>FAILED:</strong> The job encountered an error</li>
                        </ul>
                    </li>
                    <li>Click on a job to view its details and logs</li>
                    <li>The status will update automatically as the job progresses</li>
                </ol>
                <div class="note">
                    <p><strong>Note:</strong> Transcoding can take several minutes depending on the size and length of
                        your video.</p>
                </div>
            </div>

            <div class="step">
                <h3><span class="step-number">3</span>View Your Transcoded Videos</h3>
                <ol>
                    <li>Once a job is completed, you can view the transcoded video</li>
                    <li>Go to the Videos tab</li>
                    <li>Select the video you want to watch</li>
                    <li>Use the quality selector to switch between different resolutions (360p, 480p, 720p, 1080p)</li>
                </ol>
                <div class="note">
                    <p><strong>Note:</strong> The transcoded videos are stored in your S3 bucket in the
                        <code>output/[video-id]/</code> directory. The HLS playlist is at
                        <code>output/[video-id]/master.m3u8</code>.
                    </p>
                </div>
            </div>
        </div>

        <div id="limitations" class="tab-content">
            <h2>Serverless Limitations</h2>

            <div class="warning">
                <h3>Important: Transcoding Simulation in Vercel</h3>
                <p>When deployed on Vercel or similar serverless platforms, the video transcoding functionality has
                    significant limitations:</p>
                <ol>
                    <li><strong>Transcoding is simulated, not actual:</strong> In serverless mode, the application only
                        creates job objects but doesn't actually perform video transcoding.</li>
                    <li><strong>Execution time limits:</strong> Serverless functions typically timeout after 10-60
                        seconds, which is insufficient for video processing.</li>
                    <li><strong>No persistent file storage:</strong> Serverless platforms like Vercel don't provide
                        persistent storage for large video files.</li>
                    <li><strong>Memory and CPU constraints:</strong> Serverless functions have limited memory (usually
                        1-4GB) and CPU resources.</li>
                </ol>
            </div>

            <h3>How to Get Full Functionality</h3>
            <p>To use actual video transcoding capabilities, you need to run this application on a traditional server:
            </p>

            <div class="step">
                <h4><span class="step-number">1</span>Deploy on a Server</h4>
                <p>Choose one of these server options:</p>
                <ul>
                    <li>AWS EC2 instance (t3.medium or larger recommended)</li>
                    <li>DigitalOcean Droplet (4GB RAM or higher)</li>
                    <li>Any Linux/Windows server with Node.js installed</li>
                </ul>
            </div>

            <div class="step">
                <h4><span class="step-number">2</span>Install and Configure</h4>
                <p>On your server, run these commands:</p>
                <div class="code-block">
                    # Clone the repository
                    git clone https://github.com/devinllc/video-consumer.git
                    cd video-consumer

                    # Install dependencies
                    npm install

                    # Configure environment (optional)
                    cp .env.example .env
                    # Edit .env with your settings

                    # Start the application
                    npm start
                </div>
            </div>

            <div class="step">
                <h4><span class="step-number">3</span>Access Your Server</h4>
                <p>Once running, access the application at:</p>
                <div class="code-block">
                    http://YOUR_SERVER_IP:3001
                </div>
                <p>Then configure your AWS credentials through the UI.</p>
            </div>

            <h3>Alternative Solutions for Video Transcoding</h3>
            <p>If you need video transcoding in a production environment, consider these options:</p>
            <ul>
                <li><strong>AWS MediaConvert:</strong> AWS's managed service specifically designed for video transcoding
                </li>
                <li><strong>AWS Lambda with extended timeout:</strong> For moderate transcoding tasks</li>
                <li><strong>AWS Batch:</strong> For heavy batch processing of videos</li>
                <li><strong>AWS Elemental:</strong> For professional-grade video processing</li>
            </ul>
        </div>

        <div id="troubleshooting" class="tab-content">
            <h2>Troubleshooting</h2>
            <p>If you encounter any issues, here are some steps you can take:</p>
            <ul>
                <li>Check the job logs for detailed error messages</li>
                <li>Verify that your ECS cluster and task definition are correctly configured</li>
                <li>Make sure your IAM user has the necessary permissions</li>
                <li>Check that your subnets have internet access (for Fargate tasks)</li>
                <li>Verify that the task definition uses the correct container image</li>
            </ul>
        </div>
    </div>

    <script>
        function openTab(tabName) {
            // Hide all tab contents
            var tabContents = document.getElementsByClassName("tab-content");
            for (var i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }

            // Remove active class from all tabs
            var tabs = document.getElementsByClassName("tab");
            for (var i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove("active");
            }

            // Show the selected tab content and mark the tab as active
            document.getElementById(tabName).classList.add("active");

            // Find and activate the clicked tab
            var tabs = document.getElementsByClassName("tab");
            for (var i = 0; i < tabs.length; i++) {
                if (tabs[i].getAttribute("onclick").includes(tabName)) {
                    tabs[i].classList.add("active");
                }
            }
        }
    </script>
</body>

</html>